# stock-machine-learning

## 1. データの収集と前処理

学習の基盤となる高品質なデータセットを構築します。

**銘柄選定:** 時価総額上位100位の銘柄を対象とし 、米ドル等の法定通貨にペグされたステーブルコインを除外します 。

**データ取得:** `CoinGecko` 等のAPIを使用し、日次の終値（UTC 0:00時点）と時価総額を取得します 。

**ラベル作成（Targets）:** 各日の全銘柄のリターンをソートし、中央値（Median）以上の銘柄に「1」、それ以外に「0」を割り当てます 。

**特徴量生成（Features）:**

**RNN用:** 過去90日間のリターンシーケンスを作成し、トレーニングセットの平均と標準偏差で標準化します 。

**木モデル用:** 1, 2...20, 30...90日前といった特定のラグ（計27個）を持たせた累積リターンを算出します 。

## 2. モデルの構築と訓練

論文で最も高いパフォーマンス（シャープレシオ3.23）を記録した**LSTM**を中心に構成します 。

* **アーキテクチャ設計:**

**入力層:** 長さ90の時系列リターンデータ 。

**再帰層:** 5〜20ユニットのLSTMまたはGRUレイヤー（ドロップアウト0.1） 。

**全結合層:** 5ニューロンのReLU層、および1ニューロンのシグモイド出力層 。

**学習設定:** `Adam` オプティマイザを用い、バイナリクロスエントロピー損失を最小化します 。過学習防止のため、検証セットの損失に基づいた「早期終了（Early Stopping）」を導入します 。

**アンサンブル学習:** 乱数シードを変えて10個のモデルを訓練し、それぞれの予測ランクを平均化することで予測の安定性を高めます 。

## 3. バックテストと運用戦略

「精度59%」を利益に変換するためのポートフォリオ管理を実装します。

* **ポートフォリオ形成 ( 戦略):**
* モデルの予測ランクに基づき、上位5銘柄をロング（買い）、下位5銘柄をショート（売り）する「ドル中立型」ポートフォリオを作成します 。

* 毎日ポジションを解消し、新たな予測に基づきリバランスを行います 。
**コスト評価:** 片道15bps（0.15%）の取引コストを差し引いた後の純資産価値（NAV）を計算します 。
**評価指標:** シャープレシオ、ソルティノレシオ、および最大ドローダウンを用いて、リスク調整後のリターンを検証します 。

## 4. システムの最適化

論文の理論を現実の取引環境に適応させます。

* **Rustへの移植:** 学習済みモデルを `ONNX` 形式で出力し、Rustの `ort` クレート等で推論エンジンを実装することで、リアルタイム実行を高速化します。
**周期の短縮:** 論文は日次データですが、あなたの興味がある「リード・ラグ効果」を組み込み、5分足や1分足での実行にスケールダウンさせることで、より多くの裁定機会を狙える可能性があります 。

**実行基盤:** 現在構築中のWSL（Ubuntu）環境から、ゆくゆくは取引所サーバーに近いコロケーション環境へのデプロイを検討します。

---

まずは **「ステップ1：過去の時価総額上位100銘柄のヒストリカルデータ収集」** から着手するのが良さそうです。

具体的に、どのプログラミング言語（Pythonでの学習か、Rustでの推論か）から詳細な実装コードを検討していきましょうか？
